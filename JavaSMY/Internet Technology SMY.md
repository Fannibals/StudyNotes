



### Internet Technology SMY



#### 1. 计算机网络体系结构

+ 分类：OSI， TCP/IP， 五层

##### 1.1 OSI (Open System Interconnection) 体系结构

+ 分层、概念清楚，但不实用
+ 七层：



##### 1.2 TCP/IP 体系结构

+ 含了一系列构成互联网基础的网络协议，是`Internet`的**核心协议** & 被广泛应用于局域网 和 广域网

| Layer          | Functionality                                                | 传输单位 | Function                                                | Protocols |
| -------------- | ------------------------------------------------------------ | -------- | ------------------------------------------------------- | --------- |
| Application    | 定义应用进程间通信&交互的规则                                | bit      |                                                         | HTTP, DNS |
| Transport      | 向上层提供通讯服务                                           | TCP/UDP  | 为端对端的连接提供可靠的传输服务 (流量控制、差错控制等) | TCP,UDP   |
| Internet       |                                                              | Packet   | 封装数据称分组/包、路由与寻址                           | IP        |
| Network Access | 为设备间的数据通信提供传输媒体及互联设备、并提供数据的可靠传递 | Frame    | 组帧、差错控制，传输管理                                | PPP,STP   |





#### 2. TCP 协议

> Transport Control Protocol 
>
> **应用于 Http/Https、FTP等协议**

**2.1 特点**

+ 面向连接、面向字节流、全双工通信、可靠

| 特点       | 描述                                                         |
| ---------- | ------------------------------------------------------------ |
| 面向连接   | 使用TCP传输数据前，必须先建立TCP连接，完成后再释放           |
| 全双工通信 | 建立TCP连接后，通信双方都能发送消息                          |
| 可靠       | 不丢失、无差错、不重复、按序到达                             |
| 面向字节流 | 数据以流的形式进行传输  （TCP一次传输的报文长度有限制、若太大需分块，分次传输） |



**2.2 优缺点**

+ 优点：数据传输可靠
+ 缺点：效率慢（因需建立连接、发送确认包等）



**2.3 TCP segment**

+ **consists of two parts: header + Data**

+ ![Screen Shot 2020-02-22 at 5.57.29 pm](/Users/Ethan/Desktop/Fannibals.github.io/JavaSMY/Screen Shot 2020-02-22 at 5.57.29 pm.png)

![Screen Shot 2020-02-22 at 5.59.28 pm](/Users/Ethan/Desktop/Fannibals.github.io/JavaSMY/Screen Shot 2020-02-22 at 5.59.28 pm.png)

+ **Sequence Number:** 

  **if SYN:**

  +  == 0: 
  +  == 1: 

+ **Acknowledgement Number** 

  + 若ack = N, 则表明序号N-1为止的所有数据都已经正确收到

+ **SYN** -- 同步位

  + 建立连接时用于同步Seq
  + **SYN = 1，ACK = 0：表明这是一个<font color=red>链接请求报文段</font>**
  + **SYN = 1，ACK = 1：表明这是一个<font color=red>链接请求响应报文段</font>**

+ **FIN**

  + 释放连接
  + FIN = 1：表明segment的发送方已发送数据完毕 & 要求释放连接



**2.4 建立连接：三次握手**

+ 

**为什么要三次握手**

+ 防止服务器端因接收了**早已失效的连接请求报文**，从而一直等待客户端请求，最终导致**形成死锁、浪费资源**

  

**什么是SYN洪泛攻击**

+ **<font color=red>服务端的TCP资源分配时刻 = 完成第二次握手时</font>**；而客户端的TCP资源分配时刻 = 完成第三次握手时

+ **这就使得服务器易于受到`SYN`洪泛攻击**，即同时多个客户端发起连接请求，从而需进行多个请求的TCP连接资源分配

  

**2.5 释放连接：四次挥手**

+ 

**为何要四次？**

+ 为了保证通信双方都能通知对方 需要释放 & 断开连接

**为何要等2MSL？ **

+ ```MSL = 最长报文段寿命（Maximum Segment Lifetime)```

+ **原因1：为了保证客户端发送的最后1个连接释放确认报文 能到达服务器，从而使得服务器能正常释放连接**
+ **原因2：防止 上文提到的早已失效的连接请求报文 出现在本连接中**



----

**2.6 无差错传输**

+ 相对于UDP，TCP是可靠的，无差错的，但是为什么？

  

**2.6.1 滑动窗口 协议**

- 对于发送端：

  - 每收到一个确认帧，发送窗口就向前**滑动一个帧的距离**

  + 当发送窗口内**无可发送的帧时**（即窗口内的帧全部是已发送但未收到确认的帧），发送方就会停止发送，直到收到接收方发送的确认帧使窗口移动，**窗口内有可以发送的帧**，之后才开始继续发送



+ 对于接收端：
  + 当收到数据帧后，将窗口向前移动一个位置，并发回确认帧，若收到的数据帧落在接收窗口之外，则一律丢弃。



**2.6.2 无差错传输的解决方案**

+ 核心思想：采用一些可靠传输协议，使得

  1. 出现差错时，让发送方重传差错数据：即 **出错重传 **---（1）
  2. 当接收方来不及接收收到的数据时，可通知发送方降低发送数据的效率：即 **速度匹配** --- （2）

+ **自动重传协议（1）** 和 **流量控制 & 拥塞控制协议 （2）**

  

**2.6.3** **自动重传协议 （Auto Repeat Request）ARQ**

| 类型             | 原理                                    | 特点                              |
| ---------------- | --------------------------------------- | --------------------------------- |
| Stop & Wait      | (单帧滑动窗口) stop-wait + 超时重传     | 发送窗口大小 = 1、接收窗口大小= 1 |
| Go-Back-N        | (多帧滑动窗口) 累计确认+后退N+ 超时重传 | 发送窗口大小 > 1、接收窗口大小= 1 |
| Selective Repeat | (多帧滑动窗口) 累计确认+后退N+ 超时重传 | 发送窗口大小 > 1、接收窗口大小> 1 |

![Screen Shot 2020-02-22 at 8.11.18 pm](/Users/Ethan/Desktop/Fannibals.github.io/JavaSMY/Screen Shot 2020-02-22 at 8.11.18 pm.png)



#### 3. UDP

> User Datagram Protocol
>
> **应用协议：FTP，DNS**

**3.1 特点**

| 特点       | 描述                               |
| ---------- | ---------------------------------- |
| 无连接     | 使用UDP传输数据前，不需建立UDP连接 |
| 无拥塞控制 | 由于不可靠，因此无需管             |
| 不可靠     | 不丢失、无差错、不重复、按序到达   |
| 面向packet | 数据以packet的形式传输             |

**3.2 优缺点**

- 优点：速度快
- 缺点：消息易丢失（特别是 网络较差时）



**3.3 Datagram头部格式**

![Screen Shot 2020-02-22 at 8.18.26 pm](/Users/Ethan/Desktop/Fannibals.github.io/JavaSMY/Screen Shot 2020-02-22 at 8.18.26 pm.png)



### TCP vs UDP

1. **特点**
   + **是否面向连接**
   + **传输可靠性**
   + **传输形式**
2. **性能**
   + **传输效率**
   + **所需资源**
3. **应用场景**



#### 4. HTTP

> HyperText Transfer Protocol, belongs to **Application layer**

**4.1 作用**

**规定了 应用进程间通信的准则**



**4.2 特点**

1. **传输效率高**
   + **无连接**
   + **无状态**
   + **传输格式简单**
2. **传输可靠性高** -- **TCP**
3. 兼容性好
4. 灵活性高 -- 可传输任意类型的数据对象



**4.3 请求报文**

+ 由**请求行、请求头 & 请求体**组成

+ **1. 请求行：request line**
  + **作用**
    **声明** **请求方法 、主机域名、资源路径 & 协议版本**
  + **结构**
    **请求行的组成 = 请求方法 + 请求路径 + 协议版本**

+ **2. 请求头 **
  + **作用：声明 客户端、服务器 / 报文的部分信息**
  + **header：value 对的形式**

+ **3. 请求体**
  + **作用：存放 需发送给服务器的数据信息**



**4.4 响应报文结构**

+ **1. 状态行**
  + **作用**
    声明 协议版本，状态码，状态码描述
    + **1xx：表示信息通知，如请求收到了/正在处理**
    + **2xx：成功**
    + **3xx：重定向**
    + **4xx：客户端错误（400：参数有错）**
    + **5xx：服务器错误（500: 服务器内部错误）**
+ **2. 响应头**
+ **3. 响应体**





#### 5. Socket

> **是应用层 与 `TCP/IP` 协议族通信的中间软件抽象层，表现为一个封装了 TCP / IP协议族 的编程接口（API）**

+ IP + Port Number

+  Port Number: 标识正在计算机上运行的进程（程序 ）

  

#### 6. 其他知识

**6.1 在浏览器中输入`url`地址 ->> 显示主页的过程**

> 打开一个网页，整个过程会使用哪些协议

**6.2 Cookie 与 Token**



**6.3 Http vs. Https**

？